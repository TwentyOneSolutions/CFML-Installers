<project>
    <shortName>railo</shortName>
    <fullName>Railo</fullName>
    <version>3.2.2.000-pl1</version>
    <leftImage>railo-sidebar.png</leftImage>
    <logoImage>railo-logo.png</logoImage>
    <splashImage>railo-splash.png</splashImage>
    <defaultLanguage>auto</defaultLanguage>
    <allowLanguageSelection>1</allowLanguageSelection>
    <initializationActionList>
        <registryGet>
            <abortOnError>0</abortOnError>
            <key>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\InetStp</key>
            <name>PathWWWRoot</name>
            <showMessageOnError>0</showMessageOnError>
            <variable>iisrootpointer</variable>
            <wowMode>64</wowMode>
            <ruleList>
                <platformTest type="windows"/>
            </ruleList>
        </registryGet>
        <setInstallerVariable name="my_prefix" persist="1" value="${env(systemdrive)}/railo">
            <ruleList>
                <platformTest type="windows"/>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable name="my_prefix" persist="1" value="/opt/railo">
            <ruleList>
                <platformTest type="linux"/>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>apachebinaryloc</name>
            <persist>1</persist>
            <value>/usr/sbin/httpd</value>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>apachecontrolloc</name>
            <persist>1</persist>
            <value>/etc/init.d/httpd</value>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>apachemodulesloc</name>
            <persist>1</persist>
            <value>/usr/lib/httpd/modules/</value>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>apachemodulesloc</name>
            <persist>1</persist>
            <value>/usr/lib64/httpd/modules/</value>
            <ruleList>
                <platformTest>
                    <type>linux-x64</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>apacheconfigloc</name>
            <persist>1</persist>
            <value>/etc/httpd/conf/httpd.conf</value>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>apachelogloc</name>
            <persist>1</persist>
            <value>/var/log/httpd/</value>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>apachecontrolloc</name>
            <persist>1</persist>
            <value>/etc/init.d/apache2</value>
            <ruleList>
                <fileExists>
                    <path>/etc/init.d/apache2</path>
                </fileExists>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>apachemodulesloc</name>
            <persist>1</persist>
            <value>/usr/lib/apache2/modules/</value>
            <ruleList>
                <fileExists>
                    <path>/usr/lib/apache2/modules/</path>
                </fileExists>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>apachemodulesloc</name>
            <persist>1</persist>
            <value>/usr/lib64/apache2/modules/</value>
            <ruleList>
                <fileExists>
                    <path>/usr/lib64/apache2/modules/</path>
                </fileExists>
                <platformTest>
                    <type>linux-x64</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>apacheconfigloc</name>
            <persist>1</persist>
            <value>/etc/apache2/apache2.conf</value>
            <ruleList>
                <fileExists>
                    <path>/etc/apache2/apache2.conf</path>
                </fileExists>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>apachelogloc</name>
            <persist>1</persist>
            <value>/var/log/apache2/</value>
            <ruleList>
                <fileExists>
                    <path>/var/log/apache2/</path>
                </fileExists>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>installiis</name>
            <show>0</show>
            <value>no</value>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>installconn</name>
            <show>0</show>
            <value>no</value>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>installconn</name>
            <show>0</show>
            <value>yes</value>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>bittype</name>
            <value>64</value>
            <ruleList>
                <platformTest>
                    <type>linux-x64</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>bittype</name>
            <value>32</value>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
                <platformTest>
                    <negate>1</negate>
                    <type>linux-x64</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>iis_version</name>
            <persist>1</persist>
            <value>no</value>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>iis_version</name>
            <persist>1</persist>
            <value>IIS7</value>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${windows_folder_systemroot}\system32\inetsrv\appcmd.exe</path>
                </fileExists>
                <registryTest>
                    <key>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\InetStp</key>
                    <logic>exists</logic>
                    <name>MajorVersion</name>
                </registryTest>
                <registryTest>
                    <key>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\InetStp\Components</key>
                    <logic>is_not_empty</logic>
                    <name>ISAPIFilter</name>
                </registryTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>iis_version</name>
            <persist>1</persist>
            <value>IIS6</value>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <fileExists>
                    <path>${env(SYSTEMDRIVE)}\inetpub\adminscripts\adsutil.vbs</path>
                </fileExists>
                <platformTest>
                    <type>windows-2003</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>install_fr</name>
            <persist>1</persist>
            <value>0</value>
        </setInstallerVariable>
        <setInstallerVariableFromRegEx>
            <name>iiswebroot</name>
            <pattern>%SystemDrive%</pattern>
            <substitution>${env(systemdrive)}</substitution>
            <text>${iisrootpointer}</text>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <platformTest>
                    <negate>1</negate>
                    <type>windows-xp</type>
                </platformTest>
            </ruleList>
        </setInstallerVariableFromRegEx>
        <showWarning>
            <text>${msg(warnings.WinXPLimitedSupport)}</text>
            <ruleList>
                <platformTest>
                    <type>windows-xp</type>
                </platformTest>
            </ruleList>
        </showWarning>
        <setInstallerVariable>
            <name>tomcatport</name>
            <persist>1</persist>
            <value>8888</value>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>tomcatport</name>
            <ruleEvaluationLogic>or</ruleEvaluationLogic>
            <value>80</value>
            <ruleList>
                <platformTest>
                    <type>windows-xp</type>
                </platformTest>
                <platformTest>
                    <type>osx</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <showWarning>
            <ruleEvaluationLogic>or</ruleEvaluationLogic>
            <text>${msg(warnings.FRPortBusy)}</text>
            <ruleList>
                <portTest>
                    <condition>cannot_bind</condition>
                    <port>8088</port>
                </portTest>
                <portTest>
                    <condition>cannot_bind</condition>
                    <port>8114</port>
                </portTest>
            </ruleList>
        </showWarning>
        <setInstallerVariable>
            <name>iiswebroot</name>
            <persist>1</persist>
            <value></value>
            <ruleList>
                <platformTest>
                    <type>windows-xp</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
        <setInstallerVariable>
            <name>my_prefix</name>
            <value>/Library/Railo</value>
            <ruleList>
                <platformTest>
                    <type>osx</type>
                </platformTest>
            </ruleList>
        </setInstallerVariable>
    </initializationActionList>
    <postInstallationActionList>
        <substitute>
            <encoding>utf-8</encoding>
            <explanation>${msg(postInstall.CreateTomcatUserFile)}</explanation>
            <files>${installdir}/tomcat/conf/tomcat-users.xml</files>
            <type>exact</type>
            <substitutionList>
                <substitution>
                    <pattern>@@myTomcatAdminUsername@@</pattern>
                    <value>${tomcatuser}</value>
                </substitution>
                <substitution>
                    <pattern>@@myTomcatAdminPassword@@</pattern>
                    <value>${tomcatpass}</value>
                </substitution>
            </substitutionList>
        </substitute>
        <substitute>
            <encoding>utf-8</encoding>
            <explanation>${msg(postInstall.CreateControlScript)}</explanation>
            <files>${installdir}/railo_ctl</files>
            <type>exact</type>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
            <substitutionList>
                <substitution>
                    <pattern>@@installdir@@</pattern>
                    <value>${installdir}</value>
                </substitution>
            </substitutionList>
        </substitute>
        <substitute>
            <encoding>utf-8</encoding>
            <explanation>${msg(postInstall.BindingTomcat)}</explanation>
            <files>${installdir}/tomcat/conf/catalina.properties</files>
            <type>exact</type>
            <substitutionList>
                <substitution>
                    <pattern>@@installdir@@</pattern>
                    <value>${installdir}</value>
                </substitution>
            </substitutionList>
        </substitute>
        <changePermissions>
            <files>${installdir}/railo_ctl</files>
            <permissions>744</permissions>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </changePermissions>
        <addUnixService>
            <description>${msg(postInstall.CreateControlScript)}</description>
            <explanation>${msg(postInstall.InstallingService)}</explanation>
            <name>railo_ctl</name>
            <program>${installdir}/railo_ctl</program>
            <ruleList>
                <isTrue>
                    <value>${startatboot}</value>
                </isTrue>
            </ruleList>
        </addUnixService>
        <actionGroup>
            <explanation>${msg(postInstall.installing64bitmodjk)}</explanation>
            <actionList>
                <copyFile>
                    <destination>${apachemodulesloc}/mod_jk.so</destination>
                    <origin>${installdir}/tomcat_connectors/x86_64/mod_jk-1.2.28-httpd-1.3.X-eapi.so</origin>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${apachever}</value1>
                            <value2>13</value2>
                        </compareValues>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <destination>${apachemodulesloc}/mod_jk.so</destination>
                    <origin>${installdir}/tomcat_connectors/x86_64/mod_jk-1.2.31-httpd-2.0.x.so</origin>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${apachever}</value1>
                            <value2>20</value2>
                        </compareValues>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <destination>${apachemodulesloc}/mod_jk.so</destination>
                    <origin>${installdir}/tomcat_connectors/x86_64/mod_jk-1.2.31-httpd-2.2.x.so</origin>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${apachever}</value1>
                            <value2>22</value2>
                        </compareValues>
                    </ruleList>
                </copyFile>
                <createSymLink>
                    <linkName>${installdir}/sys/mod_jk.so</linkName>
                    <target>${apachemodulesloc}/mod_jk.so</target>
                </createSymLink>
                <deleteFile>
                    <path>${installdir}/tomcat_connectors/</path>
                </deleteFile>
            </actionList>
            <ruleList>
                <isTrue>
                    <value>${installconn}</value>
                </isTrue>
                <compareValues>
                    <logic>equals</logic>
                    <value1>${bittype}</value1>
                    <value2>64</value2>
                </compareValues>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </actionGroup>
        <actionGroup>
            <explanation>${msg(postInstall.installing32bitmodjk)}</explanation>
            <actionList>
                <copyFile>
                    <destination>${apachemodulesloc}/mod_jk.so</destination>
                    <origin>${installdir}/tomcat_connectors/i386/mod_jk-1.2.28-httpd-1.3.X-eapi.so</origin>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${apachever}</value1>
                            <value2>13</value2>
                        </compareValues>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <destination>${apachemodulesloc}/mod_jk.so</destination>
                    <origin>${installdir}/tomcat_connectors/i386/mod_jk-1.2.31-httpd-2.0.x.so</origin>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${apachever}</value1>
                            <value2>20</value2>
                        </compareValues>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <destination>${apachemodulesloc}/mod_jk.so</destination>
                    <origin>${installdir}/tomcat_connectors/i386/mod_jk-1.2.31-httpd-2.2.x.so</origin>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${apachever}</value1>
                            <value2>22</value2>
                        </compareValues>
                    </ruleList>
                </copyFile>
                <createSymLink>
                    <linkName>${installdir}/sys/mod_jk.so</linkName>
                    <target>${apachemodulesloc}/mod_jk.so</target>
                </createSymLink>
                <deleteFile>
                    <path>${installdir}/tomcat_connectors/</path>
                </deleteFile>
            </actionList>
            <ruleList>
                <isTrue>
                    <value>${installconn}</value>
                </isTrue>
                <compareValues>
                    <logic>equals</logic>
                    <value1>${bittype}</value1>
                    <value2>32</value2>
                </compareValues>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </actionGroup>
        <actionGroup>
            <explanation>${msg(postInstall.configuringApache)}</explanation>
            <actionList>
                <addTextToFile>
                    <file>${apacheconfigloc}</file>
                    <text>&lt;IfModule !mod_jk.c&gt;
    LoadModule jk_module @@ApacheModulesDir@@/mod_jk.so
&lt;/IfModule&gt;

&lt;IfModule mod_jk.c&gt;
    JkMount /*.cfm ajp13
    JkMount /*.cfc ajp13
    JkMount /*.do ajp13
    JkMount /*.jsp ajp13
    JkMount /*.cfchart ajp13
    JkMount /*.cfm/* ajp13
    JkMount /*.cfml/* ajp13
    # Flex Gateway Mappings
    # JkMount /flex2gateway/* ajp13
    # JkMount /flashservices/gateway/* ajp13
    # JkMount /messagebroker/* ajp13
    JkMountCopy all
    JkLogFile @@apachelogloc@@/mod_jk.log
&lt;/IfModule&gt;</text>
                </addTextToFile>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${apacheconfigloc}</files>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@ApacheModulesDir@@</pattern>
                            <value>${apachemodulesloc}</value>
                        </substitution>
                        <substitution>
                            <pattern>@@installdir@@</pattern>
                            <value>${installdir}</value>
                        </substitution>
                        <substitution>
                            <pattern>@@apachelogloc@@</pattern>
                            <value>${apachelogloc}</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <createSymLink>
                    <linkName>${installdir}/sys/apache_ctl</linkName>
                    <target>${apachecontrolloc}</target>
                </createSymLink>
                <createSymLink>
                    <linkName>${installdir}/sys/httpd.conf</linkName>
                    <target>${apacheconfigloc}</target>
                </createSymLink>
                <runProgram>
                    <program>${apachecontrolloc}</program>
                    <programArguments>restart</programArguments>
                    <show>0</show>
                </runProgram>
            </actionList>
            <ruleList>
                <isTrue>
                    <value>${installconn}</value>
                </isTrue>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </actionGroup>
        <actionGroup>
            <explanation>${msg(postInstall.configuringRailoTomcat)}</explanation>
            <progressText>${msg(postInstall.configuringRailoTomcat)}</progressText>
            <ruleEvaluationLogic>or</ruleEvaluationLogic>
            <actionList>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${installdir}\tomcat\bin\service.bat</files>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@installdir@@</pattern>
                            <value>${installdir}</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <runProgram>
                    <program>${installdir}\tomcat\bin\service.bat</program>
                    <programArguments>install Railo</programArguments>
                </runProgram>
                <runProgram>
                    <program>${installdir}\tomcat\bin\autostart.bat</program>
                    <programArguments></programArguments>
                    <show>0</show>
                    <ruleList>
                        <isTrue>
                            <value>${startatboot}</value>
                        </isTrue>
                    </ruleList>
                </runProgram>
            </actionList>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </actionGroup>
        <substitute>
            <encoding>utf-8</encoding>
            <explanation>${msg(postInstall.modifyingTomcatPort)}</explanation>
            <files>${installdir}\tomcat\conf\server.xml</files>
            <progressText>${msg(postInstall.modifyingTomcatPort)}</progressText>
            <type>exact</type>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
            <substitutionList>
                <substitution>
                    <pattern>@@tomcatport@@</pattern>
                    <value>${tomcatport}</value>
                </substitution>
            </substitutionList>
        </substitute>
        <substitute>
            <encoding>utf-8</encoding>
            <explanation>${msg(postInstall.configuringTomcatPort)}</explanation>
            <files>${installdir}/tomcat/conf/server.xml</files>
            <progressText>${msg(postInstall.configuringTomcatPort)}</progressText>
            <type>exact</type>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
            <substitutionList>
                <substitution>
                    <pattern>@@tomcatport@@</pattern>
                    <value>${tomcatport}</value>
                </substitution>
            </substitutionList>
        </substitute>
        <actionGroup>
            <explanation>${msg(postInstall.installingII7Connector)}</explanation>
            <progressText>${msg(postInstall.installingII7Connector)}</progressText>
            <show>0</show>
            <actionList>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${installdir}\connector\iis7connect.bat</files>
                    <show>0</show>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@installdir@@</pattern>
                            <value>${installdir}</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${installdir}\connector\iis7remove.bat</files>
                    <show>0</show>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@installdir@@</pattern>
                            <value>${installdir}</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${installdir}\connector\isapi_redirect-1.2.31.properties</files>
                    <show>0</show>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@installdir@@</pattern>
                            <value>${installdir}</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <renameFile>
                    <customErrorMessage>${msg(postInstall.errRenamingDLL)}</customErrorMessage>
                    <destination>${installdir}\connector\isapi_redirect-1.2.31.dll</destination>
                    <origin>${installdir}\connector\isapi_redirect-1.2.31.32-bit.dll</origin>
                    <ruleList>
                        <platformTest>
                            <negate>1</negate>
                            <type>windows-x64</type>
                        </platformTest>
                    </ruleList>
                </renameFile>
                <renameFile>
                    <customErrorMessage>${msg(postInstall.errRenamingDLL)}</customErrorMessage>
                    <destination>${installdir}\connector\isapi_redirect-1.2.31.dll</destination>
                    <origin>${installdir}\connector\isapi_redirect-1.2.31.64-bit.dll</origin>
                    <ruleList>
                        <platformTest>
                            <type>windows-x64</type>
                        </platformTest>
                    </ruleList>
                </renameFile>
                <runProgram>
                    <program>${installdir}\connector\iis7connect.bat</program>
                    <programArguments></programArguments>
                    <show>0</show>
                </runProgram>
            </actionList>
            <onErrorActionList>
                <showWarning>
                    <text>${msg(postInstall.errIISMessage)}</text>
                </showWarning>
            </onErrorActionList>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <isTrue>
                    <value>${installiis}</value>
                </isTrue>
                <compareText>
                    <logic>equals</logic>
                    <text>${iis_version}</text>
                    <value>IIS7</value>
                </compareText>
            </ruleList>
        </actionGroup>
        <actionGroup>
            <explanation>${msg(postInstall.installingII6Connector)}</explanation>
            <progressText>${msg(postInstall.installingII6Connector)}</progressText>
            <show>0</show>
            <actionList>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${installdir}\connector\iis6connect.bat</files>
                    <show>0</show>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@installdir@@</pattern>
                            <value>${installdir}</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${installdir}\connector\iis6remove.bat</files>
                    <show>0</show>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@installdir@@</pattern>
                            <value>${installdir}</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${installdir}\connector\isapi_redirect-1.2.31.properties</files>
                    <show>0</show>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@installdir@@</pattern>
                            <value>${installdir}</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <renameFile>
                    <customErrorMessage>${msg(postInstall.errRenamingDLL)}</customErrorMessage>
                    <destination>${installdir}\connector\isapi_redirect-1.2.31.dll</destination>
                    <origin>${installdir}\connector\isapi_redirect-1.2.31.32-bit.dll</origin>
                    <ruleList>
                        <platformTest>
                            <negate>1</negate>
                            <type>windows-x64</type>
                        </platformTest>
                    </ruleList>
                </renameFile>
                <renameFile>
                    <customErrorMessage>${msg(postInstall.errRenamingDLL)}</customErrorMessage>
                    <destination>${installdir}\connector\isapi_redirect-1.2.31.dll</destination>
                    <origin>${installdir}\connector\isapi_redirect-1.2.31.64-bit.dll</origin>
                    <ruleList>
                        <platformTest>
                            <type>windows-x64</type>
                        </platformTest>
                    </ruleList>
                </renameFile>
                <runProgram>
                    <program>${installdir}\connector\iis6connect.bat</program>
                    <programArguments></programArguments>
                    <runAs>Administrator</runAs>
                    <show>0</show>
                    <useMSDOSPath>0</useMSDOSPath>
                </runProgram>
            </actionList>
            <onErrorActionList>
                <showWarning>
                    <text>${msg(postInstall.errIISMessage)}</text>
                </showWarning>
            </onErrorActionList>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <isTrue>
                    <value>${installiis}</value>
                </isTrue>
                <compareText>
                    <logic>equals</logic>
                    <text>${iis_version}</text>
                    <value>IIS6</value>
                </compareText>
                <platformTest>
                    <negate>1</negate>
                    <type>windows-xp</type>
                </platformTest>
            </ruleList>
        </actionGroup>
        <runProgram>
            <explanation>${msg(postInstall.updatingTomcatUser)}</explanation>
            <program>${installdir}/sys/change_user.sh</program>
            <programArguments>${systemuser} ${installdir} nobackup</programArguments>
            <progressText>${msg(postInstall.updatingTomcatUser)}</progressText>
            <useMSDOSPath>0</useMSDOSPath>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <actionGroup>
            <explanation>${msg(postInstall.installingFusionReactor)}</explanation>
            <progressText>${msg(postInstall.installingFusionReactor)}</progressText>
            <actionList>
                <substitute>
                    <encoding>utf-8</encoding>
                    <explanation>${msg(postInstall.installingFusionReactor)}</explanation>
                    <files>${installdir}/fusionreactor/instance/default/conf/reactor.conf</files>
                    <progressText>Configuring FusionReactor</progressText>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@installdir@@</pattern>
                            <value>${installdir.unix}</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <copyFile>
                    <destination>${installdir}/tomcat/lib/fusionreactor.jar</destination>
                    <explanation>${msg(postInstall.bindingFRtoTomcat)}</explanation>
                    <origin>${installdir}/fusionreactor/etc/lib/fusionreactor.jar</origin>
                    <progressText>${msg(postInstall.bindingFRtoTomcat)}</progressText>
                </copyFile>
                <copyFile>
                    <destination>/usr/lib/libFusionReactor-linux-x86_64.so</destination>
                    <origin>${installdir}/fusionreactor/etc/lib/libFusionReactor-linux-x86_64.so</origin>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${bittype}</value1>
                            <value2>64</value2>
                        </compareValues>
                        <platformTest>
                            <type>linux</type>
                        </platformTest>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <destination>/usr/lib/libFusionReactor.so</destination>
                    <origin>${installdir}/fusionreactor/etc/lib/libFusionReactor.so</origin>
                    <ruleList>
                        <compareValues>
                            <logic>equals</logic>
                            <value1>${bittype}</value1>
                            <value2>32</value2>
                        </compareValues>
                        <platformTest>
                            <type>linux</type>
                        </platformTest>
                    </ruleList>
                </copyFile>
                <substitute>
                    <encoding>utf-8</encoding>
                    <explanation>${msg(postInstall.creatingFRFilter)}</explanation>
                    <files>${installdir}/tomcat/conf/web.xml</files>
                    <progressText>${msg(postInstall.creatingFRFilter)}</progressText>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>&lt;!-- @@frfilter@@ --&gt;</pattern>
                            <value>    &lt;filter&gt;
        &lt;filter-name&gt;FusionReactor&lt;/filter-name&gt;
        &lt;filter-class&gt;com.intergral.fusionreactor.filter.FusionReactorFilter&lt;/filter-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;config&lt;/param-name&gt;
            &lt;param-value&gt;@@DOLLAR@@{catalina.home}/../fusionreactor/instance/default/conf/reactor.conf&lt;/param-value&gt;
        &lt;/init-param&gt;
    &lt;/filter&gt;
    &lt;filter-mapping&gt;
        &lt;filter-name&gt;FusionReactor&lt;/filter-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/filter-mapping&gt;</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <substitute>
                    <files>${installdir}/tomcat/conf/web.xml</files>
                    <type>regexp</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@DOLLAR@@</pattern>
                            <value>$</value>
                        </substitution>
                    </substitutionList>
                </substitute>
            </actionList>
            <ruleList>
                <compareValues>
                    <logic>equals</logic>
                    <value1>${install_fr}</value1>
                    <value2>1</value2>
                </compareValues>
            </ruleList>
        </actionGroup>
        <deleteFile>
            <path>${installdir}/fusionreactor/</path>
            <ruleList>
                <compareValues>
                    <logic>equals</logic>
                    <value1>${install_fr}</value1>
                    <value2>0</value2>
                </compareValues>
            </ruleList>
        </deleteFile>
        <runProgram>
            <program>${installdir}/railo_ctl</program>
            <programArguments>start</programArguments>
            <show>0</show>
            <useMSDOSPath>0</useMSDOSPath>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <startWindowsService>
            <abortOnError>0</abortOnError>
            <delay>15000</delay>
            <displayName>Apache Tomcat Railo</displayName>
            <explanation>${msg(postInstall.startingRailo)}</explanation>
            <progressText>${msg(postInstall.startingRailo)}</progressText>
            <serviceName>Railo</serviceName>
        </startWindowsService>
        <actionGroup>
            <explanation>{$msg(postInstall.configuringRailoTomcat)}</explanation>
            <actionList>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${installdir}/connector/org.apache.tomcat.plist</files>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@installdir@@</pattern>
                            <value>${installdir}</value>
                        </substitution>
                        <substitution>
                            <pattern>@@RuntAtLoadFlag@@</pattern>
                            <value>true</value>
                            <ruleList>
                                <isTrue>
                                    <value>${startatboot}</value>
                                </isTrue>
                            </ruleList>
                        </substitution>
                        <substitution>
                            <pattern>@@RuntAtLoadFlag@@</pattern>
                            <value>false</value>
                            <ruleList>
                                <isFalse>
                                    <value>${startatboot}</value>
                                </isFalse>
                            </ruleList>
                        </substitution>
                    </substitutionList>
                </substitute>
                <copyFile>
                    <destination>/Library/LaunchDaemons/org.apache.tomcat.plist</destination>
                    <origin>${installdir}/connector/org.apache.tomcat.plist</origin>
                </copyFile>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${installdir}/tomcat/conf/server.xml</files>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@tomcatport@@</pattern>
                            <value>${tomcatport}</value>
                        </substitution>
                        <substitution>
                            <pattern>@@iisrootref@@</pattern>
                            <value></value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <changeOSXAttributes>
                    <creator>root</creator>
                    <files>/Library/LaunchDaemons/org.apache.tomcat.plist</files>
                    <type></type>
                </changeOSXAttributes>
                <changePermissions>
                    <files>${installdir}/tomcat/bin/*</files>
                    <permissions>755</permissions>
                </changePermissions>
                <changePermissions>
                    <files>${installdir}/tomcat/fusionreactor/etc/cp/unix/*</files>
                    <permissions>755</permissions>
                    <ruleList>
                        <isTrue>
                            <value>${install_fr}</value>
                        </isTrue>
                    </ruleList>
                </changePermissions>
                <changePermissions>
                    <files>/Library/LaunchDaemons/org.apache.tomcat.plist</files>
                    <permissions>755</permissions>
                </changePermissions>
                <copyFile>
                    <destination>${installdir}/tomcat/webapps/ROOT/index.html</destination>
                    <origin>${installdir}/startpage/index.html</origin>
                    <ruleList>
                        <isFalse>
                            <value>${install_fr}</value>
                        </isFalse>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <destination>${installdir}/tomcat/webapps/ROOT/index.html</destination>
                    <origin>${installdir}/startpage/indexfr.html</origin>
                    <ruleList>
                        <isTrue>
                            <value>${install_fr}</value>
                        </isTrue>
                    </ruleList>
                </copyFile>
                <copyFile>
                    <destination>${installdir}/tomcat/webapps/ROOT/railo_logo.JPG</destination>
                    <origin>${installdir}/startpage/railo_logo.JPG</origin>
                </copyFile>
                <changePermissions>
                    <files>${installdir}/connector/*</files>
                    <permissions>755</permissions>
                </changePermissions>
                <runProgram>
                    <abortOnError>0</abortOnError>
                    <explanation>${msg(postInstall.startingRailo)}</explanation>
                    <program>${installdir}/connector/railostart.sh</program>
                    <programArguments></programArguments>
                    <useMSDOSPath>0</useMSDOSPath>
                    <workingDirectory>${installdir}/connector/</workingDirectory>
                </runProgram>
            </actionList>
            <ruleList>
                <platformTest>
                    <type>osx</type>
                </platformTest>
            </ruleList>
        </actionGroup>
        <actionGroup>
            <progressText>Installing VHost Copier</progressText>
            <actionList>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${installdir}/vhc/config.conf</files>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>@@installdir@@</pattern>
                            <value>${installdir}</value>
                        </substitution>
                        <substitution>
                            <pattern>@@tomcatport@@</pattern>
                            <value>${tomcatport}</value>
                        </substitution>
                        <substitution>
                            <pattern>@@myTomcatAdminUsername@@</pattern>
                            <value>${tomcatuser}</value>
                        </substitution>
                        <substitution>
                            <pattern>@@myTomcatAdminPassword@@</pattern>
                            <value>${tomcatpass}</value>
                        </substitution>
                    </substitutionList>
                </substitute>
                <addTextToFile>
                    <encoding>utf-8</encoding>
                    <file>${installdir}/vhc/config.conf</file>
                    <text>windowsroot=${windows_folder_systemroot}</text>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </addTextToFile>
                <addTextToFile>
                    <encoding>utf-8</encoding>
                    <file>${installdir}/vhc/config.conf</file>
                    <text>webservertype=Apache
httpdfile=${apacheconfigloc}</text>
                    <ruleList>
                        <isTrue>
                            <value>${installconn}</value>
                        </isTrue>
                    </ruleList>
                </addTextToFile>
                <addTextToFile>
                    <encoding>utf-8</encoding>
                    <file>${installdir}/vhc/config.conf</file>
                    <text>
webservertype=IIS6</text>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <isTrue>
                            <value>${installiis}</value>
                        </isTrue>
                        <compareText>
                            <logic>equals</logic>
                            <nocase>1</nocase>
                            <text>${iis_version}</text>
                            <value>IIS6</value>
                        </compareText>
                        <platformTest>
                            <negate>1</negate>
                            <type>windows-xp</type>
                        </platformTest>
                    </ruleList>
                </addTextToFile>
                <addTextToFile>
                    <encoding>utf-8</encoding>
                    <file>${installdir}/vhc/config.conf</file>
                    <text>
webservertype=IIS7</text>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <isTrue>
                            <value>${installiis}</value>
                        </isTrue>
                        <compareText>
                            <logic>equals</logic>
                            <text>${iis_version}</text>
                            <value>IIS7</value>
                        </compareText>
                    </ruleList>
                </addTextToFile>
                <urlEncode>
                    <text>${apacheconfigloc}</text>
                    <variable>url_apacheconfigloc</variable>
                    <ruleList>
                        <isTrue>
                            <value>${installconn}</value>
                        </isTrue>
                    </ruleList>
                </urlEncode>
                <wait>
                    <ms>5000</ms>
                    <progressText>Waiting for Servlet Files [5]...</progressText>
                    <ruleList>
                        <fileExists>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/railo-server.xml</path>
                        </fileExists>
                        <fileContentTest>
                            <logic>contains</logic>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/railo-server.xml</path>
                            <text>&lt;/railo-configuration&gt;</text>
                        </fileContentTest>
                    </ruleList>
                </wait>
                <wait>
                    <ms>5000</ms>
                    <progressText>Waiting for Servlet Files [10]...</progressText>
                    <ruleList>
                        <fileExists>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/railo-server.xml</path>
                        </fileExists>
                        <fileContentTest>
                            <logic>contains</logic>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/railo-server.xml</path>
                            <text>&lt;/railo-configuration&gt;</text>
                        </fileContentTest>
                    </ruleList>
                </wait>
                <wait>
                    <ms>5000</ms>
                    <progressText>Waiting for Servlet Files [15]...</progressText>
                    <ruleList>
                        <fileExists>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/railo-server.xml</path>
                        </fileExists>
                        <fileContentTest>
                            <logic>contains</logic>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/railo-server.xml</path>
                            <text>&lt;/railo-configuration&gt;</text>
                        </fileContentTest>
                    </ruleList>
                </wait>
                <wait>
                    <ms>5000</ms>
                    <progressText>Waiting for Servlet Files [20]...</progressText>
                    <ruleList>
                        <fileExists>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/railo-server.xml</path>
                        </fileExists>
                        <fileContentTest>
                            <logic>contains</logic>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/railo-server.xml</path>
                            <text>&lt;/railo-configuration&gt;</text>
                        </fileContentTest>
                    </ruleList>
                </wait>
                <substitute>
                    <encoding>utf-8</encoding>
                    <files>${installdir}/lib/railo-server/context/railo-server.xml</files>
                    <type>exact</type>
                    <substitutionList>
                        <substitution>
                            <pattern>&lt;/railo-configuration&gt;</pattern>
                            <value>&lt;gateways&gt;
&lt;gateway cfc-path="railo.extension.gateway.DirectoryWatcher" class="" custom="directory=${url_apacheconfigloc}&amp;amp;interval=10000&amp;amp;changeFunction=startWebserver2TomcatVHostCopier&amp;amp;extensions=*.conf&amp;amp;recurse=true&amp;amp;addFunction=startWebserver2TomcatVHostCopier&amp;amp;deleteFunction=startWebserver2TomcatVHostCopier" id="webserver2TomcatVHostCopier" listener-cfc-path="webserver2tomcatVHostCopier.DirectoryListener" read-only="false" startup-mode="automatic"/&gt;
&lt;/gateways&gt;
&lt;/railo-configuration&gt;</value>
                            <ruleList>
                                <isTrue>
                                    <value>${installconn}</value>
                                </isTrue>
                            </ruleList>
                        </substitution>
                        <substitution>
                            <pattern>&lt;/railo-configuration&gt;</pattern>
                            <value>&lt;gateways&gt;
&lt;gateway cfc-path="railo.extension.gateway.DirectoryWatcher" class="" custom="directory=${iiswebroot}&amp;amp;interval=5000&amp;amp;changeFunction=startWebserver2TomcatVHostCopier&amp;amp;extensions=xml&amp;amp;recurse=false&amp;amp;addFunction=startWebserver2TomcatVHostCopier&amp;amp;deleteFunction=startWebserver2TomcatVHostCopier" id="webserver2TomcatVHostCopier" listener-cfc-path="webserver2tomcatVHostCopier.DirectoryListener" read-only="false" startup-mode="automatic"/&gt;
&lt;/gateways&gt;
&lt;/railo-configuration&gt;</value>
                            <ruleList>
                                <platformTest>
                                    <type>windows</type>
                                </platformTest>
                                <isTrue>
                                    <value>${installiis}</value>
                                </isTrue>
                                <compareText>
                                    <logic>equals</logic>
                                    <text>${iis_version}</text>
                                    <value>IIS6</value>
                                </compareText>
                                <platformTest>
                                    <negate>1</negate>
                                    <type>windows-xp</type>
                                </platformTest>
                            </ruleList>
                        </substitution>
                        <substitution>
                            <pattern>&lt;/railo-configuration&gt;</pattern>
                            <value>&lt;gateways&gt;
&lt;gateway cfc-path="railo.extension.gateway.DirectoryWatcher" class="" custom="directory=C%3A%5Cwindows%5CSystem32%5Cinetsrv%5Cconfig%5C&amp;amp;interval=5000&amp;amp;changeFunction=startWebserver2TomcatVHostCopier&amp;amp;extensions=config&amp;amp;recurse=false&amp;amp;addFunction=startWebserver2TomcatVHostCopier&amp;amp;deleteFunction=startWebserver2TomcatVHostCopier" id="webserver2TomcatVHostCopier" listener-cfc-path="webserver2tomcatVHostCopier.DirectoryListener" read-only="false" startup-mode="automatic"/&gt;
&lt;/gateways&gt;
&lt;/railo-configuration&gt;</value>
                            <ruleList>
                                <platformTest>
                                    <type>windows</type>
                                </platformTest>
                                <isTrue>
                                    <value>${installiis}</value>
                                </isTrue>
                                <compareText>
                                    <logic>equals</logic>
                                    <text>${iis_version}</text>
                                    <value>IIS7</value>
                                </compareText>
                            </ruleList>
                        </substitution>
                    </substitutionList>
                </substitute>
                <wait>
                    <ms>5000</ms>
                    <progressText>Waiting for Servlet Gateway [5]...</progressText>
                    <ruleList>
                        <fileExists>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/gateway/</path>
                        </fileExists>
                    </ruleList>
                </wait>
                <wait>
                    <ms>5000</ms>
                    <progressText>Waiting for Servlet Gateway [10]...</progressText>
                    <ruleList>
                        <fileExists>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/gateway/</path>
                        </fileExists>
                    </ruleList>
                </wait>
                <wait>
                    <ms>5000</ms>
                    <progressText>Waiting for Servlet Gateway [15]...</progressText>
                    <ruleList>
                        <fileExists>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/gateway/</path>
                        </fileExists>
                    </ruleList>
                </wait>
                <wait>
                    <ms>5000</ms>
                    <progressText>Waiting for Servlet Gateway [20]...</progressText>
                    <ruleList>
                        <fileExists>
                            <negate>1</negate>
                            <path>${installdir}/lib/railo-server/context/gateway/</path>
                        </fileExists>
                    </ruleList>
                </wait>
                <copyFile>
                    <destination>${installdir}/lib/railo-server/context/gateway/webserver2tomcatVHostCopier/</destination>
                    <origin>${installdir}/vhc/</origin>
                    <onErrorActionList>
                        <wait>
                            <ms>1</ms>
                        </wait>
                    </onErrorActionList>
                </copyFile>
                <deleteFile>
                    <path>${installdir}/vhc/</path>
                    <progressText>Cleaning up VHost Copier Files...</progressText>
                </deleteFile>
            </actionList>
            <ruleList>
                <isTrue>
                    <value>${vhostcopier}</value>
                </isTrue>
            </ruleList>
        </actionGroup>
    </postInstallationActionList>
    <preUninstallationActionList>
        <runProgram>
            <abortOnError>0</abortOnError>
            <program>${installdir}/connector/railostop.sh</program>
            <programArguments></programArguments>
            <runAs>root</runAs>
            <useMSDOSPath>0</useMSDOSPath>
            <ruleList>
                <platformTest>
                    <type>osx</type>
                </platformTest>
            </ruleList>
        </runProgram>
    </preUninstallationActionList>
    <postUninstallationActionList>
        <deleteFile>
            <abortOnError>0</abortOnError>
            <path>/Library/LaunchDaemons/org.apache.tomcat.plist</path>
            <ruleList>
                <platformTest>
                    <type>osx</type>
                </platformTest>
            </ruleList>
        </deleteFile>
    </postUninstallationActionList>
    <allowedLanguages>en de it ja nl pt_BR</allowedLanguages>
    <compressionAlgorithm>lzma</compressionAlgorithm>
    <enableRollback>1</enableRollback>
    <enableTimestamp>1</enableTimestamp>
    <installationLogFile>${installdir}/install.log</installationLogFile>
    <productDisplayIcon>${installdir}/railo.ico</productDisplayIcon>
    <requireInstallationByRootUser>1</requireInstallationByRootUser>
    <saveRelativePaths>1</saveRelativePaths>
    <singleInstanceCheck>1</singleInstanceCheck>
    <vendor>Vivio Technologies</vendor>
    <windows64bitMode>1</windows64bitMode>
    <windowsExecutableIcon>railo.ico</windowsExecutableIcon>
    <componentList>
        <component>
            <name>default</name>
            <description>${msg(component.RailoCore)}</description>
            <canBeEdited>0</canBeEdited>
            <detailedDescription>${msg(component.RailoCoreDesc)}</detailedDescription>
            <requiredSize>270,000</requiredSize>
            <selected>1</selected>
            <show>1</show>
            <folderList>
                <folder>
                    <description>Program Files</description>
                    <destination>${installdir}</destination>
                    <name>programfiles</name>
                    <platforms>all</platforms>
                    <distributionFileList>
                        <distributionFile>
                            <origin>railo.ico</origin>
                        </distributionFile>
                    </distributionFileList>
                </folder>

	<!-- windows all begin: COMMON FILES FOR WINDOWS 32 AND 64 BIT -->
	<folder>
                    <description>Windows All</description>
                    <destination>${installdir}</destination>
                    <name>windowsAll</name>
                    <platforms>windows</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>railo32-windows/connector</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/lib</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/fusionreactor</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/vhc</origin>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>

	<!-- windows all end -->
	<folder>
                    <description>Windows x64</description>
                    <destination>${installdir}</destination>
                    <name>windowsx64</name>
                    <platforms>windows</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>railo64-windows/jdk</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo64-windows/tomcat</origin>
                        </distributionDirectory>
                    </distributionFileList>
                    <ruleList>
                        <platformTest type="windows-x64"/>
                    </ruleList>
                </folder>
                <folder>
                    <description>Windows x86</description>
                    <destination>${installdir}</destination>
                    <name>windowsx86</name>
                    <platforms>windows</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>railo32-windows/jdk</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo32-windows/tomcat</origin>
                        </distributionDirectory>
                    </distributionFileList>
                    <ruleList>
	<!-- We don't have a rule to windows-x86 so we check is windows and is not windows-x64 -->
	<platformTest type="windows"/>
                        <platformTest negate="1" type="windows-x64"/>
                    </ruleList>
                </folder>
                <folder>
                    <description>Program Files</description>
                    <destination>${installdir}</destination>
                    <name>programfileslinux</name>
                    <platforms>linux</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>railo32-linux/jdk</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/sys</origin>
                        </distributionDirectory>
                        <distributionFile>
                            <origin>railo32-linux/railo_ctl</origin>
                        </distributionFile>
                        <distributionDirectory>
                            <origin>railo-all/tomcat</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/lib</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/tomcat_connectors</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo64-linux/sys</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/fusionreactor</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/vhc</origin>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>Program Files</description>
                    <destination>${installdir}</destination>
                    <name>programfileslinux64</name>
                    <platforms>linux-x64</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>railo64-linux/jdk</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/sys</origin>
                        </distributionDirectory>
                        <distributionFile>
                            <origin>railo64-linux/railo_ctl</origin>
                        </distributionFile>
                        <distributionDirectory>
                            <origin>railo-all/tomcat</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/lib</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/tomcat_connectors</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo64-linux/sys</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/fusionreactor</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/vhc</origin>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>Program Files (Mac)</description>
                    <destination>${installdir}</destination>
                    <name>mac</name>
                    <platforms>osx</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>railo64-windows/tomcat</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/fusionreactor</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-all/lib</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-macosx/connector</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>railo-macosx/startpage</origin>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
            </folderList>
            <postUninstallationActionList>
                <removeUnixService>
                    <explanation>${msg(postInstall.removingService)}</explanation>
                    <name>railo_ctl</name>
                    <ruleList>
                        <platformTest>
                            <type>linux</type>
                        </platformTest>
                    </ruleList>
                </removeUnixService>
            </postUninstallationActionList>
            <preUninstallationActionList>
                <getSymLinkTarget>
                    <link>${installer_directory}/sys/mod_jk.so</link>
                    <variable>modjklocation</variable>
                    <ruleList>
                        <platformTest>
                            <type>linux</type>
                        </platformTest>
                    </ruleList>
                </getSymLinkTarget>
                <deleteFile>
                    <path>${modjklocation}</path>
                    <ruleList>
                        <fileExists>
                            <path>${modjklocation}</path>
                        </fileExists>
                        <platformTest>
                            <type>linux</type>
                        </platformTest>
                    </ruleList>
                </deleteFile>
                <getSymLinkTarget>
                    <link>${installer_directory}/sys/httpd.conf</link>
                    <variable>apacheconfigloc</variable>
                    <ruleList>
                        <platformTest>
                            <type>linux</type>
                        </platformTest>
                    </ruleList>
                </getSymLinkTarget>
                <runConsoleProgram>
                    <program>${installer_directory}/sys/remove_connector.sh</program>
                    <programArguments>${apacheconfigloc}</programArguments>
                    <show>0</show>
                    <ruleList>
                        <fileExists>
                            <path>${installer_directory}/sys/httpd.conf</path>
                        </fileExists>
                        <platformTest>
                            <type>linux</type>
                        </platformTest>
                    </ruleList>
                </runConsoleProgram>
                <deleteFile>
                    <path>${installer_directory}/sys/httpd.conf</path>
                    <ruleList>
                        <platformTest>
                            <type>linux</type>
                        </platformTest>
                    </ruleList>
                </deleteFile>
                <runProgram>
                    <program>${installer_directory}/sys/apache_ctl</program>
                    <programArguments>restart</programArguments>
                    <show>0</show>
                    <ruleList>
                        <platformTest>
                            <type>linux</type>
                        </platformTest>
                    </ruleList>
                </runProgram>
                <runProgram>
                    <program>${installdir}\tomcat\bin\service.bat</program>
                    <programArguments>remove Railo</programArguments>
                    <show>0</show>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                    </ruleList>
                </runProgram>
                <runProgram>
                    <explanation>${msg(postInstall.removingIIS7Connector)}</explanation>
                    <program>${installdir}\connector\iis7remove.bat</program>
                    <programArguments></programArguments>
                    <progressText>${msg(postInstall.removingIIS7Connector)}</progressText>
                    <show>0</show>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <compareText>
                            <logic>equals</logic>
                            <text>${iis_version}</text>
                            <value>IIS7</value>
                        </compareText>
                    </ruleList>
                </runProgram>
                <runProgram>
                    <explanation>${msg(postInstall.removingIIS6Connector)}</explanation>
                    <program>${installdir}\connector\iis6remove.bat</program>
                    <programArguments></programArguments>
                    <progressText>${msg(postInstall.removingIIS6Connector)}</progressText>
                    <ruleList>
                        <platformTest>
                            <type>windows</type>
                        </platformTest>
                        <compareText>
                            <logic>equals</logic>
                            <text>${iis_version}</text>
                            <value>IIS6</value>
                        </compareText>
                    </ruleList>
                </runProgram>
            </preUninstallationActionList>
            <startMenuShortcutList>
                <startMenuShortcut>
                    <comment>${msg(shortCuts.RailoComment)}</comment>
                    <name>${msg(shortCuts.RailoName)}</name>
                    <runAsAdmin>0</runAsAdmin>
                    <runInTerminal>0</runInTerminal>
                    <windowsExec>${installdir}\tomcat\bin\railow.exe</windowsExec>
                    <windowsExecArgs></windowsExecArgs>
                    <windowsIcon>${installdir}\railo.ico</windowsIcon>
                    <windowsPath>${installdir}</windowsPath>
                </startMenuShortcut>
                <startMenuShortcut>
                    <comment>${msg(shortCuts.RemoveRailoComment)}</comment>
                    <name>${msg(shortCuts.RemoveRailoName)}</name>
                    <runAsAdmin>0</runAsAdmin>
                    <runInTerminal>0</runInTerminal>
                    <windowsExec>${installdir}\uninstall.exe</windowsExec>
                    <windowsExecArgs></windowsExecArgs>
                    <windowsIcon>${installdir}\railo.ico</windowsIcon>
                    <windowsPath>${installdir}</windowsPath>
                </startMenuShortcut>
                <startMenuLinkShortcut>
                    <comment>${msg(shortCuts.LaunchRailoAdminComment)}</comment>
                    <name>${msg(shortCuts.LaunchRailoAdminName)}</name>
                    <runAsAdmin>0</runAsAdmin>
                    <runInTerminal>0</runInTerminal>
                    <url>http://localhost:${tomcatport}/railo-context/admin/server.cfm</url>
                    <windowsIcon>${installdir}\railo.ico</windowsIcon>
                </startMenuLinkShortcut>
                <startMenuShortcut>
                    <comment>${msg(shortCuts.TomcatMonitorComment)}</comment>
                    <name>${msg(shortCuts.TomcatMonitorName)}</name>
                    <runAsAdmin>0</runAsAdmin>
                    <runInTerminal>0</runInTerminal>
                    <windowsExec>${installdir}\tomcat\bin\railow.exe</windowsExec>
                    <windowsExecArgs>//MS//Railo</windowsExecArgs>
                    <windowsIcon>${installdir}\railo.ico</windowsIcon>
                    <windowsPath>${installdir}</windowsPath>
                </startMenuShortcut>
                <startMenuShortcut>
                    <comment>${msg(shortCuts.TomcatHostEntryComment)}</comment>
                    <name>${msg(shortCuts.TomcatHostEntryName)}</name>
                    <runAsAdmin>0</runAsAdmin>
                    <runInTerminal>0</runInTerminal>
                    <windowsExec>notepad</windowsExec>
                    <windowsExecArgs>${installdir}\tomcat\conf\server.xml</windowsExecArgs>
                    <windowsIcon>${installdir}\railo.ico</windowsIcon>
                    <windowsPath>${installdir}</windowsPath>
                </startMenuShortcut>
                <startMenuLinkShortcut>
                    <comment>${msg(final.OpenFRURL)}</comment>
                    <name>${msg(final.OpenFRURL)}</name>
                    <runAsAdmin>0</runAsAdmin>
                    <runInTerminal>0</runInTerminal>
                    <url>http://localhost:8088</url>
                    <windowsIcon>${installdir}\railo.ico</windowsIcon>
                    <ruleList>
                        <isTrue>
                            <value>${install_fr}</value>
                        </isTrue>
                    </ruleList>
                </startMenuLinkShortcut>
            </startMenuShortcutList>
        </component>
    </componentList>
    <customLanguageFileList>
        <language>
            <code>en</code>
            <file>messages/messages.en.txt</file>
        </language>
        <language>
            <code>de</code>
            <file>messages/messages.de.txt</file>
        </language>
        <language>
            <code>it</code>
            <file>messages/messages.it.txt</file>
        </language>
        <language>
            <code>ja</code>
            <encoding>utf-8</encoding>
            <file>messages/messages.jp.txt</file>
        </language>
        <language>
            <code>nl</code>
            <file>messages/messages.nl.txt</file>
        </language>
        <language>
            <code>pt_BR</code>
            <file>messages/messages.pt_BR.txt</file>
        </language>
    </customLanguageFileList>
    <finalPageActionList>
        <launchBrowser>
	<!-- <explanation>${msg(final.OpenRailoURL)}</explanation> -->
	<progressText>${msg(final.OpenRailoURL)}</progressText>
            <url>http://localhost:${tomcatport}/index.cfm</url>
        </launchBrowser>

	<!-- installer does not handle opening two browser windows. so we can only open one page
     thus commenting this out.
        <launchBrowser>
            <explanation>${msg(final.OpenFRURL)}</explanation>
            <progressText>${msg(final.OpenFRURL)}</progressText>
            <url>http://localhost:8088</url>
            <ruleList>
                <isTrue>
                    <value>${install_fr}</value>
                </isTrue>
            </ruleList>
        </launchBrowser>
-->
	    </finalPageActionList>
    <parameterList>
        <directoryParameter>
            <name>installdir</name>
            <description>Installer.Parameter.installdir.description</description>
            <explanation>Installer.Parameter.installdir.explanation</explanation>
            <value></value>
            <default>${my_prefix}</default>
            <allowEmptyValue>0</allowEmptyValue>
            <cliOptionName>prefix</cliOptionName>
            <mustBeWritable>1</mustBeWritable>
            <mustExist>0</mustExist>
            <width>30</width>
        </directoryParameter>
        <stringParameter>
            <name>tomcatuser</name>
            <title>${msg(tomcat.PageTitle)}</title>
            <description>${msg(tomcat.UserName)}</description>
            <explanation>${msg(tomcat.Description)}</explanation>
            <value></value>
            <default>admin</default>
            <allowEmptyValue>0</allowEmptyValue>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>tomcatpass</name>
            <title>${msg(tomcat.PasswordTitle)}</title>
            <description>${msg(tomcat.PasswordDesc)}</description>
            <explanation>${msg(tomcat.PasswordExplanation)}</explanation>
            <value></value>
            <default></default>
            <allowEmptyValue>0</allowEmptyValue>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>tomcatport</name>
            <title>${msg(tomcat.PortTitle)}</title>
            <description>${msg(tomcat.PortDesc)}</description>
            <explanation>${msg(tomcat.PortExplanation)}</explanation>
            <value>${tomcatport}</value>
            <default>${tomcatport}</default>
            <allowEmptyValue>0</allowEmptyValue>
            <width>6</width>
            <ruleList>
                <portTest>
                    <condition>cannot_bind</condition>
                    <port>${tomcatport}</port>
                </portTest>
            </ruleList>
            <validationActionList>
                <throwError>
                    <text>${msg(tomcat.PortErr)}</text>
                    <ruleList>
                        <portTest>
                            <condition>cannot_bind</condition>
                            <port>${tomcatport}</port>
                        </portTest>
                    </ruleList>
                </throwError>
            </validationActionList>
        </stringParameter>
        <stringParameter>
            <name>systemuser</name>
            <title>${msg(tomcat.SystemUserTitle)}</title>
            <description>${msg(tomcat.SystemUserDesc)}</description>
            <explanation>${msg(tomcat.SystemUserExplanation)}</explanation>
            <value></value>
            <default>root</default>
            <allowEmptyValue>0</allowEmptyValue>
            <width>30</width>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </stringParameter>
        <booleanParameter>
            <name>startatboot</name>
            <title>${msg(params.StartAtBootTitle)}</title>
            <description>${msg(params.StartAtBootDesc)}</description>
            <explanation>${msg(params.StartAtBootExplanation)}</explanation>
            <value></value>
            <default>yes</default>
            <displayStyle>checkbox-left</displayStyle>
        </booleanParameter>
        <booleanParameter>
            <name>installconn</name>
            <title>${msg(params.installApacheTitle)}</title>
            <description>${msg(params.installApacheDesc)}</description>
            <explanation>${msg(params.installApacheExplanation)}</explanation>
            <value></value>
            <default>true</default>
            <displayStyle>checkbox-left</displayStyle>
            <ruleList>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </booleanParameter>
        <choiceParameter>
            <name>apachever</name>
            <title>${msg(params.ApacheVersionTitle)}</title>
            <description>${msg(params.ApacheVersionDesc)}</description>
            <explanation>${msg(params.ApacheVersionExplanation)}</explanation>
            <value></value>
            <default>22</default>
            <allowEmptyValue>0</allowEmptyValue>
            <displayType>combobox</displayType>
            <ordering>default</ordering>
            <width>30</width>
            <optionList>
                <option>
                    <description></description>
                    <image></image>
                    <text>Apache 2.2</text>
                    <value>22</value>
                </option>
                <option>
                    <description></description>
                    <image></image>
                    <text>Apache 2.0</text>
                    <value>20</value>
                </option>
                <option>
                    <description></description>
                    <image></image>
                    <text>Apache 1.3</text>
                    <value>13</value>
                </option>
            </optionList>
            <ruleList>
                <isTrue>
                    <value>${installconn}</value>
                </isTrue>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </choiceParameter>
        <fileParameter>
            <name>apachecontrolloc</name>
            <title>${msg(params.ApacheControlFileTitle)}</title>
            <description>${msg(params.ApacheControlFileDesc)}</description>
            <explanation>${msg(params.ApacheControlFileExplanation)}</explanation>
            <value></value>
            <default>${apachecontrolloc}</default>
            <allowEmptyValue>0</allowEmptyValue>
            <mustBeWritable>0</mustBeWritable>
            <mustExist>1</mustExist>
            <width>30</width>
            <ruleList>
                <isTrue>
                    <value>${installconn}</value>
                </isTrue>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </fileParameter>
        <directoryParameter>
            <name>apachemodulesloc</name>
            <title>${msg(params.ApacheModulesTitle)}</title>
            <description>${msg(params.ApacheModulesDesc)}</description>
            <explanation>${msg(params.ApacheModulesExplanation)}</explanation>
            <value></value>
            <default>${apachemodulesloc}</default>
            <allowEmptyValue>0</allowEmptyValue>
            <mustBeWritable>1</mustBeWritable>
            <mustExist>1</mustExist>
            <width>30</width>
            <ruleList>
                <isTrue>
                    <value>${installconn}</value>
                </isTrue>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </directoryParameter>
        <fileParameter>
            <name>apacheconfigloc</name>
            <title>${msg(params.ApacheConfigFileTitle)}</title>
            <description>${msg(params.ApacheConfigFileDesc)}</description>
            <explanation>${msg(params.ApacheConfigFileExplanation)}</explanation>
            <value>${apacheconfigloc}</value>
            <default></default>
            <allowEmptyValue>0</allowEmptyValue>
            <mustBeWritable>1</mustBeWritable>
            <mustExist>1</mustExist>
            <width>30</width>
            <ruleList>
                <isTrue>
                    <value>${installconn}</value>
                </isTrue>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </fileParameter>
        <directoryParameter>
            <name>apachelogloc</name>
            <title>${msg(params.ApacheLogDirTitle)}</title>
            <description>${msg(params.ApacheLogDirDesc)}</description>
            <explanation>${msg(params.ApacheLogDirExplanation)}</explanation>
            <value></value>
            <default>${apachelogloc}</default>
            <allowEmptyValue>0</allowEmptyValue>
            <mustBeWritable>1</mustBeWritable>
            <mustExist>1</mustExist>
            <width>30</width>
            <ruleList>
                <isTrue>
                    <value>${installconn}</value>
                </isTrue>
                <platformTest>
                    <type>linux</type>
                </platformTest>
            </ruleList>
        </directoryParameter>
        <booleanParameter>
            <name>installiis</name>
            <title>${msg(params.installIISConnectorTitle)}</title>
            <description>${msg(params.installIISConnectorDesc)}</description>
            <explanation>${msg(params.installIISConnectorExplanation)}</explanation>
            <value>yes</value>
            <default>yes</default>
            <displayStyle>checkbox-left</displayStyle>
            <preShowPageActionList>
                <setInstallerVariable>
                    <name>installiis</name>
                    <value>yes</value>
                </setInstallerVariable>
                <showWarning>
                    <progressText>${msg(warnings.ISAPIprogressText)}</progressText>
                    <text>${msg(warnings.ISAPIText)}</text>
                    <ruleList>
                        <registryTest>
                            <key>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\InetStp\Components\</key>
                            <logic>does_not_exist</logic>
                            <name>ISAPIExtensions</name>
                            <wowMode>32</wowMode>
                        </registryTest>
                        <compareText>
                            <logic>equals</logic>
                            <text>${iis_version}</text>
                            <value>IIS7</value>
                        </compareText>
                    </ruleList>
                </showWarning>
                <showWarning>
                    <progressText>${msg(warnings.detectISAPIFiltersPT)}</progressText>
                    <text>${msg(warnings.detectISAPIFilterText)}</text>
                    <ruleList>
                        <registryTest>
                            <key>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\InetStp\Components\</key>
                            <logic>does_not_exist</logic>
                            <name>ISAPIFilter</name>
                            <wowMode>32</wowMode>
                        </registryTest>
                        <compareText>
                            <logic>equals</logic>
                            <text>${iis_version}</text>
                            <value>IIS7</value>
                        </compareText>
                    </ruleList>
                </showWarning>
            </preShowPageActionList>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
                <compareValues>
                    <logic>does_not_equal</logic>
                    <value1>${iis_version}</value1>
                    <value2>no</value2>
                </compareValues>
                <platformTest>
                    <negate>1</negate>
                    <type>windows-xp</type>
                </platformTest>
            </ruleList>
        </booleanParameter>
        <choiceParameter>
            <name>bittype</name>
            <title>${msg(params.bitTypeTitle)}</title>
            <description>${msg(params.bitTypeDesc)}</description>
            <explanation>${msg(params.bitTypeExplanation)}</explanation>
            <value>${bittype}</value>
            <default>${bittype}</default>
            <allowEmptyValue>0</allowEmptyValue>
            <displayType>combobox</displayType>
            <insertAfter>apachever</insertAfter>
            <ordering>default</ordering>
            <ruleEvaluationLogic>or</ruleEvaluationLogic>
            <width>30</width>
            <optionList>
                <option>
                    <description>32-bit</description>
                    <image></image>
                    <text>32-bit</text>
                    <value>32</value>
                </option>
                <option>
                    <description>64-bit</description>
                    <image></image>
                    <text>64-bit</text>
                    <value>64</value>
                </option>
            </optionList>
            <ruleList>
                <platformTest>
                    <type>linux-x64</type>
                </platformTest>
            </ruleList>
        </choiceParameter>
        <booleanParameter>
            <name>install_fr</name>
            <title>${msg(params.InstallFRTitle)}</title>
            <description>${msg(params.InstallFRDesc)}</description>
            <explanation>${msg(params.InstallFRExplanation)}</explanation>
            <value>yes</value>
            <default>no</default>
            <displayStyle>checkbox-left</displayStyle>
        </booleanParameter>
        <booleanParameter>
            <name>vhostcopier</name>
            <title>Install VHost Copier?</title>
            <description>Install VHost Copier? [${installconn}]</description>
            <explanation>Would you like to install the VHost Copier on to your system? This module will automatically configure your sites in Tomcat/Railo.

If you do not install this module, you will need to manually configure your sites in Tomcat.

Note: After installation, you can manage this module from the Railo Server Administrator. </explanation>
            <value>yes</value>
            <default>yes</default>
            <displayStyle>checkbox-left</displayStyle>
            <ruleEvaluationLogic>or</ruleEvaluationLogic>
            <ruleList>
                <isTrue>
                    <value>${installconn}</value>
                </isTrue>
                <isTrue>
                    <value>${installiis}</value>
                </isTrue>
            </ruleList>
        </booleanParameter>
    </parameterList>
    <platformOptionsList>
        <platformOptions>
            <platform>linux</platform>
        </platformOptions>
        <platformOptions>
            <platform>linux-x64</platform>
        </platformOptions>
    </platformOptionsList>
</project>

